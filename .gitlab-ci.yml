stages:
  - install
  - test

install:
  stage: install
  tags:
    - python
  script:
  - conda env list
  - conda remove --name calphy_test --all
  - conda config --add channels conda-forge
  - conda create --name calphy_test python=3.7 pytest tqdm numpy scipy pyyaml mendeleev lammps mpi4py openmpi pylammpsmpi pyscal pytest --force
  - conda env list

test:
  stage: test
  tags:
    - python
  script:
  - source activate calphy_test
  - python setup.py install
  - pytest tests/
